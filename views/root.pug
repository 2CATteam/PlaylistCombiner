doctype html
html
	head
		title Spotify Guessing Game 
		meta(charset="utf-8")
		meta(name="description" content="A game where you guess who listens to what Spotify songs")
		meta(name="viewport" content="width=device-width, initial-scale=1.0")
		link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous")
		link(rel="stylesheet", type="text/css" href="/styles.css")
	body 
		.d-flex.justify-content-center.bg-success.p-5.min-vh-100
			.d-flex.w-100.justify-content-center.align-items-center.p-5#wrapContainer.bg-light.rounded-5
				.d-flex.flex-column.root-half
					h1.text-wrap Spotify Guessing Game! 
					p.text-wrap Play with your friends and stuff! Guess who's listening to what songs! 
					p.text-wrap Can play with up to a million people! 
					p.text-wrap Can use your most-listened or a custom playlist! 
					p.text-wrap Generate the fun quiz! 
					p.text-wrap Play separate or together!
					p.text-wrap Even more text! 
				.vr.m-5.landscapeOnly
				hr.m-5.w-100.portraitOnly
				.d-flex.flex-column.root-half
					h3.text-wrap Get started now! 
					.mb-3 
						label.form-label(for="sessionName") Session Name 
						input#sessionName.form-control(type="text", name="sessionName")
					.mb-3 
						label.form-label(for="songCount") Songs per Person
						select#songCount.form-control
							option(value="3") 3
							option(value="5") 5
							option(value="10") 10
							option(value="20") 20
					button.btn.btn-primary(type="button", onclick="createSession()") Create session 
					p.form-text.text-wrap You will be redirected to a page for your session. Once you get there, share the page with your friends to invite them!
		script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous") 
		script. 
			function getRequest(url, callback) {
				let submitReq = new XMLHttpRequest()
				submitReq.addEventListener("load", callback);
				submitReq.open("GET", url)
				submitReq.send()
			}

			function postRequest(url, body, callback) {
				let submitReq = new XMLHttpRequest();
				submitReq.addEventListener("load", callback);
				submitReq.open("POST", url);
				submitReq.setRequestHeader("Content-type", "application/json");
				submitReq.send(JSON.stringify(body));
			}

			function createSession() {
				let name = document.querySelector("#sessionName").value
				let size = document.querySelector("#songCount").value
				postRequest(`/addSession`, {name: name, size: size}, function() {
					console.log(this.status)
					console.log(this.responseText)

					if (this.status != 200) {
						alert("Could not create session - please try again later!")
					} else {
						let response = JSON.parse(this.responseText)
						let sessionId = response.sessionId
						window.location.href = `/${sessionId}`
					}
				})
			}